<!-- Cookie Banner  -->

<div id="cookie-banner" class="cookie-banner">
  <div class="cookie-content">
    <div class="cookie-icon">
      üç™
    </div>
    <div class="cookie-text">
      <h4>Diese Website verwendet Cookies</h4>
      <p>Hier werden Cookies verwendet, um die Nutzung meiner Website zu analysieren und Ihre Erfahrung zu verbessern.</p>
    </div>
    <div class="cookie-buttons">
      <button id="cookie-decline" class="cookie-btn secondary">Nur notwendige</button>
      <button id="cookie-accept" class="cookie-btn primary">Alle akzeptieren</button>
    </div>
  </div>
</div>

<script is:inline>
  // Cookie Banner Logik
  function initCookieBanner() {
    const banner = document.getElementById('cookie-banner');
    const acceptBtn = document.getElementById('cookie-accept');
    const declineBtn = document.getElementById('cookie-decline');
    
    // Pr√ºfen ob bereits eine Entscheidung getroffen wurde
    const consent = getCookie('analytics_consent');
    
    if (consent !== null) {
      banner.style.display = 'none';
      if (consent === 'true') {
        loadGoogleAnalytics();
      }
    } else {
      banner.style.display = 'block';
    }
    
    // Akzeptieren Button
    acceptBtn.onclick = function() {
      setCookie('analytics_consent', 'true', 180); // 6 Monate
      banner.style.display = 'none';
      loadGoogleAnalytics();
    };
    
    // Ablehnen Button
    declineBtn.onclick = function() {
      setCookie('analytics_consent', 'false', 90); // 3 Monate
      banner.style.display = 'none';
    };
  }
  
  // Cookie setzen
  function setCookie(name, value, days) {
    const expires = new Date();
    expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
    document.cookie = name + '=' + value + ';expires=' + expires.toUTCString() + ';path=/;SameSite=Lax';
  }
  
  // Cookie lesen
  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for(let i = 0; i < ca.length; i++) {
      let c = ca[i];
      while (c.charAt(0) === ' ') c = c.substring(1, c.length);
      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
  }
  
  // Google Analytics laden
  function loadGoogleAnalytics() {
    // gtag Script laden
    const script = document.createElement('script');
    script.async = true;
    script.src = 'https://www.googletagmanager.com/gtag/js?id=G-VZT8LE9CZP';
    document.head.appendChild(script);
    
    // gtag konfigurieren
    script.onload = function() {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-VZT8LE9CZP', {
        anonymize_ip: true,
        cookie_flags: 'SameSite=Lax;Secure'
      });
      window.gtag = gtag;
    };
  }
  
  // Banner initialisieren wenn DOM geladen ist
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCookieBanner);
  } else {
    initCookieBanner();
  }
</script>

<style>
  .cookie-banner {
    position: fixed;
    bottom: 20px;
    left: 20px;
    right: 20px;
    max-width: 420px;
    margin: 0 auto;
    background: var(--background);
    border: 1px solid var(--accent-background-2);
    border-radius: 16px;
    box-shadow: var(--box-shadow);
    z-index: 10000;
    display: none;
    padding: 24px;
    font-family: 'Instrument Sans', sans-serif;
    animation: slideUp 0.3s ease-out;
  }
  
  @keyframes slideUp {
    from {
      transform: translateY(100px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }
  
  .cookie-content {
    display: flex;
    flex-direction: column;
    gap: 16px;
    align-items: center;
    text-align: center;
  }
  
  .cookie-icon {
    font-size: 2.5em;
    margin-bottom: 8px;
  }
  
  .cookie-text h4 {
    margin: 0 0 8px 0;
    font-size: 1.2em;
    font-weight: 600;
    color: var(--font);
    line-height: 1.3;
  }
  
  .cookie-text p {
    margin: 0;
    font-size: 0.95em;
    color: rgb(var(--gray));
    line-height: 1.5;
  }
  
  .cookie-buttons {
    display: flex;
    gap: 12px;
    width: 100%;
    margin-top: 8px;
  }
  
  .cookie-btn {
    flex: 1;
    padding: 12px 20px;
    border: none;
    border-radius: 12px;
    font-size: 0.95em;
    font-weight: 600;
    font-family: inherit;
    cursor: url('/cursor.png') 16 16, auto;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }
  
  .cookie-btn:hover {
    transform: translateY(-2px);
  }
  
  .cookie-btn.primary {
    background: #000000;
    color: white;
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.2);
  }
  
  .cookie-btn.primary:hover {
    background: #282936;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
  }
  
  .cookie-btn.secondary {
    background: white;
    color: #000000;
    border: 1px solid #000000;
  }
  
  .cookie-btn.secondary:hover {
    background: #000000;
    color: white;
    border-color: #000000;
  }
  
  /* Responsive Design */
  @media (max-width: 480px) {
    .cookie-banner {
      bottom: 10px;
      left: 10px;
      right: 10px;
      padding: 20px;
    }
    
    .cookie-buttons {
      flex-direction: column;
    }
    
    .cookie-btn {
      flex: none;
      padding: 14px 20px;
    }
    
    .cookie-text h4 {
      font-size: 1.1em;
    }
    
    .cookie-text p {
      font-size: 0.9em;
    }
  }
  
  /* Tablet Layout */
  @media (min-width: 768px) {
    .cookie-banner {
      bottom: 30px;
      left: 30px;
      right: auto;
      max-width: 400px;
    }
  }
  
  /* Desktop Layout */
  @media (min-width: 1024px) {
    .cookie-banner {
      bottom: 40px;
      left: 40px;
      max-width: 420px;
    }
  }
</style>